关于gns模拟器的搭建，有如下几个地方需要注意：

### 1）windows安装时，下载的all-in-one，重要的有如下几个部分

- linux安装时，添加如下软件源:

  ```bash
  sudo add-apt-repository ppa:gns3/ppa
  sudo apt-get update
  sudo apt-get install gns3 dynamips vpcs
  ```

- Dynamips：这个主要是用来运行cisco路由器中的ios系统的，cisco路由器最好选用c3600系列中的
	  c3640这个，据说工作起来比较稳定

- Sniff：   自带的wireshark，pcap，如果之前安装过了也可以不用安装，改一下preferences->capture
	  中的路径就可以了。如果是64位系统安装的话，命令执行路径默认是：
	  tail -f -c +0b %c｜"E:\Program Fils\...\wireshark.exe" -k -i -
	  如果之前安装的是32位的sniff软件，就需要改一下这里的路径Program Files (x86)。
	
	  另外，pcap，不能捕捉loopback adaptor的包，网上说可以使用rawcap来捕捉包，我试了下，
	  但是没有成功，可能当时我配置的不对也产生了影响，还需测试。

- Qemu：	  这个是用来运行cisco asa，pix and ips，其中asa，pix是防火墙

- virtualbox: 这个用来运行虚拟机，然后再与gns结合的，不过virtualbox与vmware想必，差的太远，即便是想用运行虚拟机的方式与gns结合，也应该使用vmware而不是virtualbox，不过gns官方介绍说virtualbox支持比较好。
	
	考虑到机器配置、软件所需资源、性能等问题，我使用了VPCS（即virtual pc system），它是一个独立的小程序，并非通过运行某些虚拟机，而是通过与gns的结合，方便地模拟最多9台任意网段中的主机，对资源占用极小，但是另一方面，它的功能也比较单一，可以可以执行ping、tracert等一些简单的命令，不过这对我们来说也足够用了。

### 2）路由器端口问题

路由器c3600的端口，1E，一个以太网接口，用于路由器与主机或者交换机构建子网，配置时选择接口e0/0；还有个4T，4个串口，以通过串口e0/0,e0/1,e0/2,e0/3来连接，路由器之间用它来连接。路由器连接以太网的接口上，会自动执行ethernet protocol；连接不同路由器的接口上，由于需要负责进行路由交换更新路由表，所以需要运行某些选路协议，比如自治系统内运行rip，自治系统间bgp。

路由器配置命令常用的：

```bash
	en，
	conf terminal，
	int 接口，
	ip address ip地址 子网掩码
	no shutdown
	router 路由协议
	net 为那些网段执行路由协议

	exit
```

### 3）将主机接入拓扑图，有点问题。

原先我想通过运行虚拟机，但是这样引起的问题比较多。

- 虚拟机占用系统资源多，严重影响机器相应速度。
- 借助于虚拟机的话就要开启vmnet1，vmnet8，或者virtualbox等虚拟网络，这在某些运行检查是否开启多网卡代理的程序中，比较讨厌，比如锐捷，电信宽带。
- 通过在windows设备管理器里面添加过时的硬件，选择microsoft的loopback adaptor，但是奇怪的是我的gns3在cloud配置下面找不到建好的loopback adaptor。
- 等等吧。

发现比较好的方案，就是选择VPCS，即virtual pc system，它是一个小程序，通过与gns
的完美结合，可以提供模仿主机的服务，运行一些常见的主机命令，如ping，tracert等等，够用了。

如何接入主机呢？

1. 启动vpcs；
    配置好几台主机的ip，网关，子网掩码；
2. 在gns里面preferences->system manager中选择computer，添加到右侧列表，更名为pc，将type更换为cloud，这是因为只有cloud才可以真正的与外部主机相连接。
3. 从gns主界面4大面板中的设备节点中，将pc拖入工作区域，在configure中，选择标签页nio udp，通过选择端口号与vpcs中的主机号进行对应，如何对应呢？
     组合（20000,127.0.0.1，30000）对应着vpcs中的1号主机（20001,127.0.0.1,30001）对应着vpcs中的2号主机，以此类推，最多模拟9台主机。

这种方式应该也可以适用于cloud，其实cloud不用也可以，一些网络问题，我们自己设计个拓扑大部分就可以解决了。

### 4）集线器hub与中继器relay

集线器hub，中继器relay，都是物理层设备，它们都是将入端口收到的信号放大之后，再转发出去。不同点是，集线器有多个端口，向除入端口之外的其他所有端口广播，而中继器只有两个端口，只能将信号放大后从一个出口传出去。

通过vpcs建立的虚拟主机，发送的包、接收的包，无法通过wireshark进行捕捉，为了获知其发送和接收的包，可以通过在其与其他设备连接的线路上通过集线器hub进行连接，并在集线器的某个口上再连接一个路由器，这样对路由器进行捕捉包就可以了解到集线器广播的包，适当的加过滤条件，就可以知道主机发送与接收的数据包了。

帧中继交换机frame relay switch，不是我们通常说的链路层的交换机。
1）帧中继交换机，是通过DLCI（data link connection identifier，即数据链路连接标志）来设定一条虚电路VC的源端和目的端。它是利用了数据链路的统计复用。帧中继交换机，在广域网中使用，例如用来在相邻路由器的窗口之间进行连接。
2）我们通常所说的链路层的交换机，工作在局域网中，通过MAC地址进行转发，与路由器进行连接的时候，用的不是路由器的窗口，而是路由器的以太网接口。
3）帧中继交换机需要配置才能使用，链路层交换机不需要配置就可以使用。

### 5）其他发现的使用问题

如果给路由器添加的是4E模块，那么如果对应的接口没有与以太网链路相连接的话，默认的情况下，该接口是被路由器关闭了的。

